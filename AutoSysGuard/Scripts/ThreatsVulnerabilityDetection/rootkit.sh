#!/bin/bash
# rootkit_detection.sh

# Function to install chkrootkit if not already installed
install_chkrootkit() {
  if ! command -v chkrootkit &> /dev/null; then
    echo "chkrootkit is not installed. Installing..."
    sudo apt update
    sudo apt install -y chkrootkit
  fi
}

# Function to run chkrootkit
run_chkrootkit() {
  echo "Running chkrootkit to scan for rootkits..."
  sudo chkrootkit
}

# Function to check system logs
check_logs() {
  echo "Checking system logs for suspicious entries..."

  # Check dmesg for rootkit-related entries
  dmesg | grep -i "rootkit"
  
  # Check the last login attempts for the root user
  last -n 10 | grep "root"
}

# Main execution
install_chkrootkit
run_chkrootkit
check_logs
echo "Rootkit detection complete."
