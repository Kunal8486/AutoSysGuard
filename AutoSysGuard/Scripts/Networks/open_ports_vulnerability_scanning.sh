#!/bin/bash

# Function to check root privileges
check_root() {
    if [ "$EUID" -ne 0 ]; then
        zenity --error --text="This script must be run as root." --title="Permission Denied"
        exit 1
    fi
}

# Function to scan for open ports
scan_open_ports() {
    local target=$1
    zenity --info --text="Scanning open ports for $target..." --title="Open Ports Scan"
    open_ports=$(nmap -p- --min-rate=1000 "$target" | grep 'open' | awk '{print $1, $2}')

    if [ -z "$open_ports" ]; then
        zenity --info --text="No open ports found for $target." --title="Open Ports Scan"
    else
        zenity --info --text="Open Ports for $target:\n\n$open_ports" --title="Open Ports Scan"
    fi
}

# Function to perform vulnerability scanning on open ports
scan_vulnerabilities() {
    local target=$1
    zenity --info --text="Performing vulnerability scan on $target..." --title="Vulnerability Scan"
    vulnerabilities=$(nmap --script vuln "$target")

    if [ -z "$vulnerabilities" ]; then
        zenity --info --text="No vulnerabilities found for $target." --title="Vulnerability Scan"
    else
        zenity --info --text="Vulnerability Scan Results for $target:\n\n$vulnerabilities" --title="Vulnerability Scan"
    fi
}

# Function to get target input
get_target() {
    target=$(zenity --entry --title="Open Ports and Vulnerability Scanning" --text="Enter the target IP address or hostname:")
    if [ -n "$target" ]; then
        scan_open_ports "$target"
        scan_vulnerabilities "$target"
    else
        zenity --error --text="No target provided!" --title="Error"
    fi
}

# Main function to run the scans
run_scans() {
    check_root
    get_target
    zenity --info --text="Open Ports and Vulnerability Scanning Completed." --title="Scanning Complete"
}

# Start the scans
run_scans
